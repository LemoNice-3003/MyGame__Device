<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<title>複数の円からマウスまで線</title>
<style>
  body { margin:0; height:100vh; display:flex; align-items:center; justify-content:center; background:#111; }
  svg { width:90vw; height:90vh; border:1px solid #333; background:#fff; touch-action:none; }
  .circle { fill:#4AA; }
  .line { stroke:#E33; stroke-width:.5; stroke-linecap:round; }
</style>
</head>
<body>
<svg id="svg">
  <!-- 複数の円 -->
  <circle class="circle" cx="10" cy="10" r="3"></circle>
  <circle class="circle" cx="10" cy="40" r="3"></circle>
  <circle class="circle" cx="10" cy="70" r="3"></circle>
  <circle class="circle" cx="10" cy="100" r="3"></circle>
  <circle class="circle" cx="10" cy="130" r="3"></circle>
  <circle class="circle" cx="10" cy="160" r="3"></circle>
  
  <circle class="circle" cx="40" cy="10" r="3"></circle>
  <circle class="circle" cx="40" cy="40" r="3"></circle>
  <circle class="circle" cx="40" cy="70" r="3"></circle>
  <circle class="circle" cx="40" cy="100" r="3"></circle>
  <circle class="circle" cx="40" cy="130" r="3"></circle>
  <circle class="circle" cx="40" cy="160" r="3"></circle>
  
  <circle class="circle" cx="70" cy="10" r="3"></circle>
  <circle class="circle" cx="70" cy="40" r="3"></circle>
  <circle class="circle" cx="70" cy="70" r="3"></circle>
  <circle class="circle" cx="70" cy="100" r="3"></circle>
  <circle class="circle" cx="70" cy="130" r="3"></circle>
  <circle class="circle" cx="70" cy="160" r="3"></circle>

  <circle class="circle" cx="100" cy="10" r="3"></circle>
  <circle class="circle" cx="100" cy="40" r="3"></circle>
  <circle class="circle" cx="100" cy="70" r="3"></circle>
  <circle class="circle" cx="100" cy="100" r="3"></circle>
  <circle class="circle" cx="100" cy="130" r="3"></circle>
  <circle class="circle" cx="100" cy="160" r="3"></circle>

  <circle class="circle" cx="130" cy="10" r="3"></circle>
  <circle class="circle" cx="130" cy="40" r="3"></circle>
  <circle class="circle" cx="130" cy="70" r="3"></circle>
  <circle class="circle" cx="130" cy="100" r="3"></circle>
  <circle class="circle" cx="130" cy="130" r="3"></circle>
  <circle class="circle" cx="130" cy="160" r="3"></circle>
  
  <circle class="circle" cx="160" cy="10" r="3"></circle>
  <circle class="circle" cx="160" cy="40" r="3"></circle>
  <circle class="circle" cx="160" cy="70" r="3"></circle>
  <circle class="circle" cx="160" cy="100" r="3"></circle>
  <circle class="circle" cx="160" cy="130" r="3"></circle>
  <circle class="circle" cx="160" cy="160" r="3"></circle>
  
  <circle class="circle" cx="190" cy="10" r="3"></circle>
  <circle class="circle" cx="190" cy="40" r="3"></circle>
  <circle class="circle" cx="190" cy="70" r="3"></circle>
  <circle class="circle" cx="190" cy="100" r="3"></circle>
  <circle class="circle" cx="190" cy="130" r="3"></circle>
  <circle class="circle" cx="190" cy="160" r="3"></circle>

  <circle class="circle" cx="220" cy="10" r="3"></circle>
  <circle class="circle" cx="220" cy="40" r="3"></circle>
  <circle class="circle" cx="220" cy="70" r="3"></circle>
  <circle class="circle" cx="220" cy="100" r="3"></circle>
  <circle class="circle" cx="220" cy="130" r="3"></circle>
  <circle class="circle" cx="220" cy="160" r="3"></circle>

</svg>

<script>
const svg = document.getElementById('svg');
const circles = Array.from(document.querySelectorAll('.circle'));
const limit = 60;

// 各円に対応する線を作成
const lines = circles.map(c => {
  const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
  line.classList.add("line");
  // 始点は円の中心
  line.setAttribute("x1", c.getAttribute("cx"));
  line.setAttribute("y1", c.getAttribute("cy"));
  line.setAttribute("x2", c.getAttribute("cx"));
  line.setAttribute("y2", c.getAttribute("cy"));
  line.style.display = "none";
  svg.appendChild(line);
  return line;
});

// マウス座標を更新
function updateLines(clientX, clientY) {
  const pt = svg.createSVGPoint();
  pt.x = clientX;
  pt.y = clientY;
  const svgP = pt.matrixTransform(svg.getScreenCTM().inverse());

  lines.forEach((line, i) => {
    const circle = circles[i];
    const cx = parseFloat(circle.getAttribute("cx"));
    const cy = parseFloat(circle.getAttribute("cy"));
    const dx = svgP.x - cx;
    const dy = svgP.y - cy;
    const dist = Math.sqrt(dx*dx + dy*dy);

    if (dist <= limit) {
      lines[i].style.display = "block";
      lines[i].setAttribute("x1", cx);
      lines[i].setAttribute("y1", cy);
      lines[i].setAttribute("x2", svgP.x);
      lines[i].setAttribute("y2", svgP.y);
    } else {
      lines[i].style.display = "none"; // 範囲外は非表示
    }
  });
}

svg.addEventListener("mousemove", e => updateLines(e.clientX, e.clientY));
svg.addEventListener("touchmove", e => {
  e.preventDefault();
  const t = e.touches[0];
  updateLines(t.clientX, t.clientY);
}, {passive:false});
</script>
</body>
</html>
